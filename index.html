<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Forklift Intelligence Platform</title>
</head>
<body>

<h2>Forklift Year Decoder</h2>

<label>Manufacturer:</label>
<select id="manufacturer">
  <option>Toyota</option>
  <option>Hyster</option>
  <option>Yale</option>
  <option>Crown</option>
  <option>Raymond</option>
</select>

<br><br>

<label>Model:</label>
<select id="model"></select>

<br><br>

<label>Serial:</label>
<input type="text" id="serial" placeholder="Enter forklift serial">

<br><br>

<button id="btn">Decode Forklift Year</button>

<div id="result"></div>

<hr>

<h2>Battery Date Decoder</h2>

<label>Battery Manufacturer:</label>
<select id="battery_manufacturer"></select>

<br><br>

<label>Battery Serial:</label>
<input type="text" id="battery_serial">

<br><br>

<button id="battery_date_btn">Decode Battery Date</button>

<div id="battery_date_result"></div>

<hr>

<h2>Battery Size Detector</h2>

<label>Forklift Manufacturer:</label>
<select id="battery_forklift_manufacturer">
  <option>Toyota</option>
  <option>Crown</option>
  <option>Hyster</option>
  <option>Yale</option>
  <option>Mitsubishi</option>
  <option>Raymond</option>
</select>

<br><br>

<label>Forklift Model:</label>
<input type="text" id="battery_model">

<br><br>

<button id="battery_size_btn">Detect Battery Size</button>

<div id="battery_size_result"></div>

<script>
document.addEventListener("DOMContentLoaded", function() {

const ANON_KEY = "PASTE_YOUR_REAL_SUPABASE_ANON_KEY_HERE";

const ENDPOINT_DECODE = "https://qoleyzrhexkddryfxznz.supabase.co/rest/v1/rpc/decode_forklift";
const ENDPOINT_MODELS = "https://qoleyzrhexkddryfxznz.supabase.co/rest/v1/rpc/get_models";
const ENDPOINT_BATT_DATE = "https://qoleyzrhexkddryfxznz.supabase.co/rest/v1/rpc/decode_battery";
const ENDPOINT_BATT_SIZE = "https://qoleyzrhexkddryfxznz.supabase.co/rest/v1/rpc/detect_battery_size";
const ENDPOINT_BATT_MFGS = "https://qoleyzrhexkddryfxznz.supabase.co/rest/v1/rpc/get_battery_manufacturers";

function el(id){ return document.getElementById(id); }

async function loadModels(){
  const mfg = el("manufacturer").value;
  const modelSelect = el("model");
  modelSelect.innerHTML = "";

  const res = await fetch(ENDPOINT_MODELS,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "apikey":ANON_KEY,
      "Authorization":"Bearer "+ANON_KEY
    },
    body:JSON.stringify({ manufacturer_input:mfg })
  });

  const data = await res.json();
  if(!data) return;

  data.forEach(m=>{
    const opt = document.createElement("option");
    opt.value = m;
    opt.text = m;
    modelSelect.appendChild(opt);
  });
}

async function loadBatteryManufacturers(){
  const select = el("battery_manufacturer");
  const res = await fetch(ENDPOINT_BATT_MFGS,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "apikey":ANON_KEY,
      "Authorization":"Bearer "+ANON_KEY
    },
    body:JSON.stringify({})
  });

  const data = await res.json();
  if(!data) return;

  select.innerHTML = "";
  data.forEach(n=>{
    const opt=document.createElement("option");
    opt.value=n;
    opt.text=n;
    select.appendChild(opt);
  });
}

async function decodeForkliftYear(){
  const mfg = el("manufacturer").value;
  const model = el("model").value;
  const serial = el("serial").value.trim();

  const res = await fetch(ENDPOINT_DECODE,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "apikey":ANON_KEY,
      "Authorization":"Bearer "+ANON_KEY
    },
    body:JSON.stringify({
      manufacturer_input:mfg,
      model_input:model,
      serial_input:serial
    })
  });

  const data = await res.json();

  el("result").innerHTML =
    "<b>"+mfg+" "+model+"</b><br>Year: "+(data.manufacture_year||"Unknown");
}

el("btn").addEventListener("click", decodeForkliftYear);
el("manufacturer").addEventListener("change", loadModels);

loadModels();
loadBatteryManufacturers();

});
</script>

</body>
</html>
